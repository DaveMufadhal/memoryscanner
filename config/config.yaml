# config/config.yaml

volatility:
  # Path to the `vol` (volatility3) CLI
  binary_path: "vol"              # or absolute path if needed
  default_plugins:
    - "windows.pslist.PsList"
    - "windows.netscan.NetScan"
    - "windows.dlllist.DllList"
    - "windows.psscan.PsScan"
    - "windows.pstree.PsTree"
    - "windows.malfind.Malfind"
    - "windows.cmdline.CmdLine"
    - "windows.handles.Handles"
    - "windows.registry.hivelist.HiveList"
    - "windows.sessions.Sessions"

analysis:
  # HIGH-CONFIDENCE malware tools (rarely legitimate)
  malware_tools:
    - "mimikatz.exe"
    - "mimikatz"
    - "procdump.exe"
    - "procdump64.exe"
    - "pwdump"
    - "gsecdump"
    - "wce.exe"
    - "fgdump"
    - "cachedump"
    - "lslsass"
  
  # Remote access tools (context-dependent)
  remote_access_tools:
    - "psexec.exe"
    - "psexesvc.exe"
    - "winexesvc.exe"
    - "remcom.exe"
    - "nc.exe"
    - "netcat.exe"
    - "plink.exe"
  
  # Legitimate Windows processes (whitelist - do NOT flag these)
  legitimate_processes:
    - "system"
    - "smss.exe"
    - "csrss.exe"
    - "wininit.exe"
    - "services.exe"
    - "lsass.exe"
    - "svchost.exe"
    - "explorer.exe"
    - "winlogon.exe"
    - "taskhost.exe"
    - "dwm.exe"
    - "spoolsv.exe"
    - "wmpnetwk.exe"
    - "mspaint.exe"
    - "notepad.exe"
    - "dumpit.exe"  # Memory dump tool
    - "conhost.exe"
    - "cmd.exe"      # Legitimate when spawned by explorer.exe
    - "wmic.exe"     # Legitimate system tool
  
  # Suspicious parent-child relationships (context matters)
  suspicious_parent_child:
    # Office apps spawning scripts
    - parent: ["winword.exe", "excel.exe", "powerpnt.exe", "outlook.exe"]
      child: ["cmd.exe", "powershell.exe", "wscript.exe", "cscript.exe", "mshta.exe"]
      severity: "HIGH"
    # Browsers spawning scripts
    - parent: ["iexplore.exe", "chrome.exe", "firefox.exe", "msedge.exe"]
      child: ["cmd.exe", "powershell.exe", "wscript.exe"]
      severity: "HIGH"
  
  # Malfind whitelist - processes that legitimately have executable memory
  malfind_whitelist:
    - "svchost.exe"
    - "explorer.exe"
    - "chrome.exe"
    - "firefox.exe"
    - "iexplore.exe"
    - "mspaint.exe"
    - "notepad.exe"
    - "wmpnetwk.exe"
    - "dwm.exe"
    - "csrss.exe"
    - "winlogon.exe"
    - "services.exe"
  
  # Suspicious network indicators
  suspicious_ports:
    - 4444  # Metasploit default
    - 5555  # Common RAT
    - 6666  # Common backdoor
    - 31337 # Elite/leet port
    - 1337
# YARA scanning configuration
yara:
  enabled: false  # Set to true when you have YARA rules
  rules_dir: "yara_rules"
  scan_memory: true

# Threat Intelligence Integration
threat_intel:
  virustotal:
    enabled: false  # Set to true and add API key
    api_key: "YOUR_VT_API_KEY_HERE"
  
  hybrid_analysis:
    enabled: false
    api_key: "YOUR_HA_API_KEY_HERE"
# MITRE ATT&CK Mapping
mitre:
  enabled: true
  # Map suspicious activities to MITRE techniques
  technique_mapping:
    credential_dumping: "T1003"
    process_injection: "T1055"
    command_execution: "T1059"
    network_connection: "T1071"

# Report Generation
report:
  output_dir: "reports"
  include_raw_sections: true
  format: "markdown"  # Options: markdown, html, pdf
  
# Scoring thresholds
scoring:
  low_risk: 10
  medium_risk: 30
  high_risk: 50
  critical_risk: 100